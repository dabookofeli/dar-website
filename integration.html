<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Integration — Digital Action Receipts (DAR)</title>
  <meta name="description" content="How to integrate Digital Action Receipts (DAR): issuance points, event taxonomy, storage under customer custody, verification, and minimal schemas." />

  <style>
    :root{
      --bg:#ffffff;
      --text:#0f172a;
      --muted:#475569;
      --muted2:#64748b;
      --line:#e2e8f0;
      --card:#f8fafc;
      --chip:#f1f5f9;
      --shadow: 0 10px 30px rgba(2, 6, 23, 0.06);
      --radius:16px;
      --radius2:22px;
      --max: 1040px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:var(--sans);
      background:var(--bg);
      color:var(--text);
      line-height:1.45;
    }
    a{ color:inherit; text-decoration:none; }
    a:hover{ text-decoration:underline; }
    .wrap{ max-width:var(--max); margin:0 auto; padding:22px 18px 60px; }

    /* Top Nav */
    .topbar{
      position:sticky; top:0;
      background:rgba(255,255,255,0.92);
      backdrop-filter:saturate(180%) blur(10px);
      border-bottom:1px solid var(--line);
      z-index:50;
    }
    .nav{
      max-width:var(--max);
      margin:0 auto;
      padding:14px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:650;
      letter-spacing:-0.01em;
    }
    .brand small{
      font-weight:600;
      color:var(--muted2);
      letter-spacing:0.08em;
      text-transform:uppercase;
      font-size:11px;
      margin-left:6px;
    }
    .navlinks{
      display:flex;
      gap:16px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .navlinks a{
      padding:8px 10px;
      border-radius:999px;
      color:var(--muted);
      font-weight:550;
      font-size:14px;
    }
    .navlinks a.active{
      background:var(--chip);
      color:var(--text);
    }

    /* Mobile menu */
    .menuBtn{
      display:none;
      border:1px solid var(--line);
      background:#fff;
      border-radius:12px;
      padding:10px 12px;
      box-shadow: 0 2px 10px rgba(2,6,23,0.04);
      cursor:pointer;
      align-items:center;
      gap:10px;
      font-weight:650;
      color:var(--text);
    }
    .menuIcon{
      width:18px; height:12px; position:relative;
    }
    .menuIcon span{
      position:absolute; left:0; right:0;
      height:2px; border-radius:2px;
      background:var(--text);
      opacity:0.75;
    }
    .menuIcon span:nth-child(1){ top:0; }
    .menuIcon span:nth-child(2){ top:5px; }
    .menuIcon span:nth-child(3){ top:10px; }

    .mobileDrawer{
      display:none;
      border-top:1px solid var(--line);
      background:#fff;
    }
    .mobileDrawer .inner{
      max-width:var(--max);
      margin:0 auto;
      padding:10px 18px 16px;
      display:grid;
      gap:10px;
    }
    .mobileDrawer a{
      padding:12px 12px;
      border:1px solid var(--line);
      border-radius:14px;
      background:var(--card);
      color:var(--muted);
      font-weight:600;
    }
    .mobileDrawer a.active{
      color:var(--text);
      border-color:#cbd5e1;
      background:#fff;
    }

    @media (max-width:820px){
      .navlinks{ display:none; }
      .menuBtn{ display:inline-flex; }
      .mobileDrawer{ display:block; }
      .mobileDrawer[hidden]{ display:none !important; }
    }

    /* Page */
    .kicker{
      margin:28px 0 10px;
      font-size:12px;
      letter-spacing:0.2em;
      text-transform:uppercase;
      color:var(--muted2);
    }
    h1{
      margin:0 0 12px;
      font-size:44px;
      letter-spacing:-0.02em;
      line-height:1.05;
    }
    .lede{
      color:var(--muted);
      font-size:18px;
      max-width:78ch;
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius2);
      padding:18px;
      box-shadow: var(--shadow);
    }
    .section{ margin-top:18px; }
    .section h2{
      margin:0 0 10px;
      font-size:18px;
      letter-spacing:-0.01em;
    }
    .small{ font-size:13px; color:var(--muted2); }
    ul{ margin:10px 0 0 18px; color:var(--muted); }
    li{ margin:6px 0; }

    .grid2{
      margin-top:18px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px;
      align-items:start;
    }
    @media (max-width:900px){
      .grid2{ grid-template-columns:1fr; }
    }

    .pillRow{
      display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;
    }
    .pill{
      background:#fff;
      border:1px solid var(--line);
      border-radius:999px;
      padding:7px 10px;
      font-size:13px;
      font-weight:650;
      color:var(--muted);
    }

    .codeBox{
      background:#fff;
      border:1px solid var(--line);
      border-radius:18px;
      padding:14px;
      overflow:auto;
      font-family:var(--mono);
      font-size:13px;
      color:#0f172a;
    }

    /* Footer */
    .footer{
      border-top:1px solid var(--line);
      margin-top:34px;
      padding:18px 0 0;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:18px;
      flex-wrap:wrap;
    }
    .footnote{ margin-top:6px; font-size:13px; color:var(--muted2); max-width:60ch; }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="nav">
      <a class="brand" href="index.html">
        <span>Digital Action Receipts</span><small>DAR</small>
      </a>

      <button class="menuBtn" id="menuBtn" aria-expanded="false" aria-controls="mobileDrawer">
        <span class="menuIcon" aria-hidden="true">
          <span></span><span></span><span></span>
        </span>
        Menu
      </button>

      <div class="navlinks" aria-label="Primary navigation">
        <a href="index.html">Home</a>
        <a href="definition.html">Definition</a>
        <a href="action-domains.html">Action Domains</a>
        <a class="active" href="integration.html">Integration</a>
        <a href="principles.html">Principles</a>
        <a href="docs.html">Docs</a>
      </div>
    </div>

    <div class="mobileDrawer" id="mobileDrawer" hidden>
      <div class="inner">
        <a href="index.html">Home</a>
        <a href="definition.html">Definition</a>
        <a href="action-domains.html">Action Domains</a>
        <a class="active" href="integration.html">Integration</a>
        <a href="principles.html">Principles</a>
        <a href="docs.html">Docs</a>
      </div>
    </div>
  </div>

  <main class="wrap">
    <div class="kicker">How to implement DAR</div>
    <h1>Integration patterns</h1>
    <p class="lede">
      DAR integration is intentionally boring: emit a receipt after an action commits (non-blocking),
      store it append-only under customer custody, and make it verifiable later.
      The value comes from stable references and integrity—not from collecting payloads.
    </p>

    <div class="section grid2">
      <div class="card">
        <h2>Where to emit a receipt</h2>
        <p class="small">Think “action boundary,” not “logging everywhere.”</p>
        <ul>
          <li>Approval granted / denied</li>
          <li>Policy version published</li>
          <li>Model inference performed (optional event)</li>
          <li>Config or infrastructure change applied</li>
          <li>Transaction executed / settlement confirmed</li>
          <li>Entitlement change / privileged action completed</li>
        </ul>
        <div class="pillRow" aria-label="tags">
          <span class="pill">post-commit</span>
          <span class="pill">non-blocking</span>
          <span class="pill">high-stakes events</span>
        </div>
      </div>

      <div class="card">
        <h2>What a receipt should contain</h2>
        <p class="small">Keep it small. Store references, not raw data.</p>
        <ul>
          <li><strong>actor</strong> — who/what performed the action</li>
          <li><strong>action</strong> — verb/event name</li>
          <li><strong>object</strong> — target (resource, record, account, etc.)</li>
          <li><strong>timestamp</strong> — when it committed</li>
          <li><strong>receipt_ref</strong> — stable reference / correlation key</li>
          <li><strong>context refs</strong> — policy_version_ref, model_version_hash, config_ref (optional)</li>
          <li><strong>integrity</strong> — signature / hash chain pointers</li>
        </ul>
      </div>
    </div>

    <div class="section card">
      <h2>Minimal schema (example)</h2>
      <div class="codeBox">
<code>{
  "id": "8F6A92",
  "ts": "2026-01-04T15:24:11Z",
  "actor": "user|system|agent",
  "action": "loan.approval.granted",
  "object": "loan_app:LA-10492",
  "receipt_ref": "corr:9b2f…",
  "policy_version_ref": "policy-2026-01",
  "model_version_hash": "sha256:…",
  "config_ref": "cfg-71a3…",
  "integrity": {
    "signature": "…",
    "hash_chain_prev": "…"
  }
}</code>
      </div>
      <p class="small" style="margin-top:10px;">
        The receipt is an evidence artifact. It should remain valid even if source systems are reconfigured later.
      </p>
    </div>

    <div class="section grid2">
      <div class="card">
        <h2>Event taxonomy (recommended)</h2>
        <p class="small">Use stable, predictable naming. Avoid app-specific language.</p>
        <div class="codeBox">
<code>loan.application.created
loan.underwriting.requested
ai.inference.performed
loan.underwriting.recommendation.issued
loan.approval.granted
loan.booked
loan.disbursement.executed</code>
        </div>
        <p class="small" style="margin-top:10px;">
          You can expand later, but the core should remain compact and defensible.
        </p>
      </div>

      <div class="card">
        <h2>Storage & custody</h2>
        <p class="small">
          Receipts should be written directly into customer-controlled immutable storage.
          DAR does not act as a system of record.
        </p>
        <ul>
          <li>AWS S3 Object Lock</li>
          <li>Azure Immutable Blob</li>
          <li>GCP Retention Bucket</li>
        </ul>
        <div class="pillRow">
          <span class="pill">append-only</span>
          <span class="pill">immutability</span>
          <span class="pill">customer custody</span>
        </div>
      </div>
    </div>

    <div class="section card">
      <h2>Verification & retrieval</h2>
      <p class="small">Verification should be possible outside the system that issued the receipt.</p>
      <ul>
        <li>Retrieve receipts by <strong>receipt_ref</strong> (correlation) or domain key (e.g., loan_app_id)</li>
        <li>Verify integrity via signature and/or hash chain pointers</li>
        <li>Confirm referenced context: policy registry, model registry, config history (as separate systems)</li>
      </ul>
      <div class="codeBox" style="margin-top:12px;">
<code>// high-level concept
receipts = store.query({ receipt_ref: "corr:9b2f…" })
verify(receipts)  // signature + chain integrity
renderTimeline(receipts)</code>
      </div>
    </div>

    <div class="section card">
      <h2>Integration checklist</h2>
      <ul>
        <li>Choose 5–20 high-stakes events (start small)</li>
        <li>Define a stable taxonomy and correlation key strategy</li>
        <li>Emit post-commit receipts (non-blocking)</li>
        <li>Write receipts to immutable storage under customer custody</li>
        <li>Provide a verification path + timeline rendering</li>
        <li>Document “what DAR does not do” (no monitoring, no enforcement)</li>
      </ul>
    </div>

    <footer class="footer">
      <div>
        <strong>© EF Digital Sol</strong>
        <span class="small" style="margin-left:10px;">Digital Action Receipts (DAR)</span>
        <div class="footnote">Neutral, verifiable receipts for digital actions.</div>
      </div>

      <div style="display:flex; gap:14px; flex-wrap:wrap;">
        <a href="definition.html">Definition</a>
        <a href="action-domains.html">Action Domains</a>
        <a href="integration.html">Integration</a>
        <a href="principles.html">Principles</a>
        <a href="docs.html">Docs</a>
      </div>
    </footer>
  </main>

  <script>
    (function(){
      const btn = document.getElementById('menuBtn');
      const drawer = document.getElementById('mobileDrawer');
      if(!btn || !drawer) return;

      btn.addEventListener('click', () => {
        const isOpen = btn.getAttribute('aria-expanded') === 'true';
        btn.setAttribute('aria-expanded', String(!isOpen));
        drawer.toggleAttribute('hidden');
      });
    })();
  </script>
</body>
</html>
